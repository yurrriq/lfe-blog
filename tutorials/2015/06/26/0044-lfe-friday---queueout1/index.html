

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      
        LFE Friday - queue:out/1 -
      
      LFE Tutorials, News, &amp; Updates
    </title>
    <meta name="description" content="">
    <meta name="author" content="LFEuminati | Alien Alliance">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/themes/hooligan/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/hooligan/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/css/twilight.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/css/overrides.css" rel="stylesheet" type="text/css" media="all">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="LFE News & Updates Atom Feed">
    <link rel="shortcut icon" href="/assets/images/favicon.ico">
    <!-- fav and touch icons -->
    <!-- Update these with your own images
      <link rel="apple-touch-icon" href="assets/images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="assets/images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="assets/images/apple-touch-icon-114x114.png">
    -->
  </head>

  <body>
    <div id="page-wrap">
      <div class="navbar">
        <div class="navbar-inner">
          <div class="container">
            <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>

	    <a class="brand" href="/"><img style="float: left; padding-right: 8px;" src="/assets/images/LispFlavoredErlang-xtinsy.png" /> LFE Tutorials, News, &amp; Updates</a>

            <div class="nav-collapse">
              <ul class="nav">
                
                
                


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/authors.html">Authors</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



		<li><a href="http://docs.lfe.io/">Docs</a></li>
		<li><a href="http://lfe.io/">lfe.io</a></li>
              </ul>
              <ul class="nav pull-right social visible-desktop">
                <li class="divider-vertical"></li>
                
                <li>
                  <a href="http://webchat.freenode.net/?channels=erlang-lisp" style="color: #999; font-size: 180%; margin-top: 3px;" target="_blank">
                    <span class=""> #</span>
                  </a>
                </li>
                
                
                <li>
                  <a href="https://github.com/lfe" class="zocial github icon" target="_blank">
                    <span class="hidden-desktop">Github</span>
                  </a>
                </li>
                
                
                <li>
                  <a href="https://plus.google.com/u/1/communities/103919485468949397234" class="zocial googleplus icon" target="_blank">
                    <span class="hidden-desktop">Google+</span>
                  </a>
                </li>
                
                
                <li>
                  <a href="https://twitter.com/ErlangLisp" class="zocial twitter icon" target="_blank">
                    <span class="hidden-desktop">Twitter</span>
                  </a>
                </li>
                
                
                
                
                <li>
                  <a href="http://feeds.feedburner.com/lfe/news-and-updates" class="zocial rss icon" target="_blank">
                    <span class="hidden-desktop">FeedBurner</span>
                  </a>
                </li>
                
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="content">
          

<div class="page-header">
  <h1>
    LFE Friday - queue:out/1
    
  </h1>
</div>

<div class="row">
  <div class="span8">
    
<p><a href="/assets/images/posts/LispFlavoredErlang-medium-square.png"><img class="left tiny" src="/assets/images/posts/LispFlavoredErlang-medium-square.png" /></a>This week's LFE Friday was translated with permission from the
<a href="http://www.proctor-it.com/category/erlang/erlang-thursday/">Erlang Thursday</a>
series by <a href="https://twitter.com/stevenproctor">Steven Proctor</a>.
<em>This week's translator</em>: Robert Virding.</p>

<p>Today's LFE Friday covers <a href="http://erlang.org/doc/man/queue.html#out-1">queue:out/1</a> from the <code>queue</code> module's Original API.</p>

<p><code>queue:out/1</code> is one of my all time Queue functions, or methods, that I have seen, and that is across all the languages and libraries that I have encountered.</p>

<p>"What makes it so great?", I can hear you asking.</p>

<p>That would be it's combination of tuples, tagged tuples, immutability, forgivingness, and the fact that after seeing the result, it makes me wish more Queue implementations had an API like this.</p>

<p>First there have been many times in my past where either myself, or someone else, has forgotten to do a check to see if a queue is empty before trying to pop the first item from it, and that mistake has resulted in a not-so-nice runtime error.</p>

<p><code>queue:out/1</code> on the other hand, doesn't trigger an error when you try to call it on an empty queue.  Rather it returns a tagged tuple telling you that the queue you tried to call <code>out</code> on was empty, and the empty queue.</p>

<div class="highlight"><pre><code class="language-lisp"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">queue:out</span> <span class="p">(</span><span class="nv">queue:new</span><span class="p">))</span>
<span class="o">#(</span><span class="nv">empty</span> <span class="o">#(</span><span class="p">()</span> <span class="p">()))</span></code></pre></div>

<p>If we do pass in a non-empty queue, <code>queue:out/1</code> returns a two tuple, with the first element being a tagged tuple that tells us we got a value out and the HEAD of the original queue, and for the second element, we get a new queue with the result of removing the first item.</p>

<div class="highlight"><pre><code class="language-lisp"><span class="nb">&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="nv">queue</span> <span class="p">(</span><span class="nv">queue:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)))</span>
<span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="nb">&gt;</span> <span class="p">(</span><span class="nv">queue:out</span> <span class="nv">queue</span><span class="p">)</span>
<span class="o">#(#(</span><span class="nv">value</span> <span class="nv">a</span><span class="p">)</span> <span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="nv">c</span><span class="p">)))</span>
<span class="nb">&gt;</span> <span class="nv">queue</span>
<span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="nb">&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="p">(</span><span class="nv">tuple</span> <span class="p">(</span><span class="nv">tuple</span> <span class="ss">&#39;value</span> <span class="nv">head</span><span class="p">)</span> <span class="nv">new-queue</span><span class="p">)</span> <span class="p">(</span><span class="nv">queue:out</span> <span class="nv">queue</span><span class="p">))</span>
<span class="o">#(#(</span><span class="nv">value</span> <span class="nv">a</span><span class="p">)</span> <span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="nv">c</span><span class="p">)))</span>
<span class="nb">&gt;</span> <span class="nv">queue</span>
<span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="nb">&gt;</span> <span class="nv">head</span>
<span class="nv">a</span>
<span class="nb">&gt;</span> <span class="nv">new-queue</span>
<span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>
<span class="nb">&gt;</span> <span class="p">(</span><span class="nv">queue:head</span> <span class="nv">new-queue</span><span class="p">)</span>
<span class="nv">b</span></code></pre></div>

<p>The fourth query is a good case for using the backquote macro.</p>

<div class="highlight"><pre><code class="language-lisp"><span class="nb">&gt;</span> <span class="p">(</span><span class="nb">set</span> <span class="o">`#(#(</span><span class="nv">value</span> <span class="o">,</span><span class="nv">head</span><span class="p">)</span> <span class="o">,</span><span class="nv">new-queue</span><span class="p">)</span> <span class="p">(</span><span class="nv">queue:out</span> <span class="nv">queue</span><span class="p">))</span>
<span class="o">#(#(</span><span class="nv">value</span> <span class="nv">a</span><span class="p">)</span> <span class="o">#(</span><span class="p">(</span><span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nv">b</span> <span class="nv">c</span><span class="p">)))</span></code></pre></div>

<p>When dealing with the abstract notion of a queue across any language, the concept of a "pop" does two things, returns the top item of the queue, and modifies the queue to have that item removed.</p>

<p>Since Erlang/LFE queues are immutable, after you think about it for a few minutes, it starts to make sense that <code>queue:out/1</code> handles both those behaviors of "pop" by returning both the item removed from the queue, and the new state of the queue with that item removed.</p>

<p>Erlang's <code>queue</code> module also provides a function <a href="http://erlang.org/doc/man/queue.html#out_r-1">queue:out_r/1</a> which behaves the same as <code>queue:out/1</code> except it operates off the last item in the queue, instead of the first item.</p>

<div class="highlight"><pre><code class="language-lisp"><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">queue:out_r</span> <span class="p">(</span><span class="nv">queue:from_list</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)))</span>
<span class="o">#(#(</span><span class="nv">value</span> <span class="nv">d</span><span class="p">)</span> <span class="o">#(</span><span class="p">(</span><span class="nv">c</span><span class="p">)</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nb">&gt;</span> <span class="p">(</span><span class="nv">queue:out_r</span> <span class="p">(</span><span class="nv">queue:new</span><span class="p">))</span>                                    
<span class="o">#(</span><span class="nv">empty</span> <span class="o">#(</span><span class="p">()</span> <span class="p">()))</span></code></pre></div>

<p>I hope you found <code>queue:out/1</code> as handy and as nice I have,</p>

<p>-Proctor, Robert</p>

    <hr>
    <div class="pagination btn-group">
      
        <a class="btn prev" href="/tutorials/2015/06/23/0353-spell1---ll1-parser-generator-update" title="spell1 - LL(1) parser generator update">&larr; Previous</a>
      
        <a class="btn" href="/archive.html">Archive</a>
      
        <a class="btn next" href="/tutorials/2015/07/04/0959-lfe-friday---ordsetsunion2" title="LFE Friday - ordsets:union/2">Next &rarr;</a>
      
    </div>
    <hr>
    
  </div>

  <div class="span4">
    <section>
      <h4>Author</h4>
      <div class="author"><span><a href="/authors.html#Robert Virding">Robert Virding</a></span></div>
    </section>
    <section>
      <h4>Published</h4>
      <div class="date"><span>26 June 2015</span></div>
    </section>
    
      <section>
        <h4>Category</h4>
        <span class="category">
          tutorials
        </span>
      </section>
    
    
      <section>
        <h4>Tags</h4>
        <ul class="tag_box">
          
          


  
     
    	<li><a href="/tags.html#lfe friday-ref">lfe friday <span>35</span></a></li>
     
    	<li><a href="/tags.html#lfe-ref">lfe <span>40</span></a></li>
     
    	<li><a href="/tags.html#erlang-ref">erlang <span>45</span></a></li>
    
  



        </ul>
      </section>
    
  </div>
</div>


        </div>
      </div> <!-- /container -->

      <div class="footer-push"></div>
    </div><!--/.page-wrap -->

    <footer>
      <div class="container">
        <p>&copy; 2014-2015 LFEuminati | Alien Alliance
        </p>
      </div>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/hooligan/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/hooligan/bootstrap/js/bootstrap.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-38274766-2', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>

